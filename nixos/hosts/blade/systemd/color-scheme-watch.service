[Unit]
Description=Monitor color scheme changes and restart dependent services
PartOf=graphical-session.target
After=graphical-session.target

[Service]
Type=simple
ExecStart=/bin/sh -c '\
  gsettings monitor org.gnome.desktop.interface color-scheme | while read -r line; do \
    systemctl --user restart waybar.service; \
    systemctl --user restart wallpaper.service; \
  done'
Restart=on-failure
RestartSec=3

[Install]
WantedBy=graphical-session.target
