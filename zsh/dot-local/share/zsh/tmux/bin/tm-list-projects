#!/usr/bin/env zsh

PROJECTS_FILE="$HOME/.tm_projects"

if [[ ! -f $PROJECTS_FILE ]]; then
  echo "The file $PROJECTS_FILE does not exist"
  exit 1
fi

while IFS= read -r dir; do
  dir="${dir#"${dir%%[![:space:]]*}"}"  # Trim leading whitespace
  dir="${dir%"${dir##*[![:space:]]}"}"  # Trim trailing whitespace
  dir="${dir/\~/$HOME}"

  if [[ "$dir" == *\** ]]; then
    dir="${dir//\*/}" # remove trailing *
    fd -td --max-depth=1 . "$dir"
  else
    echo "${expanded_dir}"
  fi
done < $PROJECTS_FILE
